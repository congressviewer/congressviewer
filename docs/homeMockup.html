<!doctype html>
<html class="no-js" lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Congress Viewer</title>
  <link rel="stylesheet" href="css/app.css">
  <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.3/css/foundation.css">-->
  <link href="https://use.fontawesome.com/releases/v5.0.7/css/all.css" rel="stylesheet">

  <link rel="icon" type="image/png" href="img/favicon.png">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-114562198-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-114562198-1');
  </script>

</head>
<body>

<div class="cvSidebar">
  <h1 class="cvSidebar_siteLogo">Congress<br class="hide-for-small-only"> <i class="fas fa-eye"></i>Viewer</h1>
  <hr class="cvSidebar_divider hide-for-small-only">
  <ul class="cvSidebar_nav hide-for-small-only">
    <li><a href="#" class="cvSidebar_navItem"><i class="fas fa-check"></i>Recent Votes</a></li>
    <li><a href="#" class="cvSidebar_navItem"><i class="far fa-calendar-alt"></i>Upcoming Bills</a></li>
    <li><a href="#" class="cvSidebar_navItem"><i class="fas fa-user-circle"></i>Representitive Info</a></li>
  </ul>
  <hr class="cvSidebar_divider hide-for-small-only">
  <ul class="cvSidebar_siteLinks hide-for-small-only">
    <li><a href="#" class="cvSidebar_siteLinksItem">About</a></li>
    <li><a href="#" class="cvSidebar_siteLinksItem">Contact</a></li>
  </ul>
</div>
<div class="cvContent">
  <div class="cvMainGrid grid-x grid-padding-x">
    <div class="cell large-8">

      <h2>Recent Votes</h2>

      <div class="cvContent_panel">
        <!--date--><h6 class="light-text float-right">2017-07-28</h6>
        <!--question--><h6 class="light-text">On Passage</h6>
        <!--description--><h4><a href="" style="color:white;text-decoration:underline;">Department of Veterans Affairs Bonus Transparency Act</a></h4>
        <!--number-title--><p>S.114 - To authorize appropriations and to appropriate amounts for the Veterans Choice Program of the Department of Veterans Affairs, to improve hiring authorities of the Department, to authorize major medical facility leases, and for other purposes.</p>
        <!--latest action--><p><strong>Became Public Law No: 115-46</strong></p>
        <hr>

        <div class="grid-x grid-padding-x">
          <div class="cell small-3">
            <h4><small>Result:</small> <span class="passed">Passed</span></h4>
          </div>
          <div class="cell small-3">
            <h4><small>Yes</small></h4>
            <span class="label democrat">186</span>
            <span class="label republican">228</span>
          </div>
          <div class="cell small-3">
            <h4><small>No</small></h4>
            <span class="label democrat">0</span>
            <span class="label republican">0</span>
          </div>
          <div class="cell small-3">
            <h4><small>Not Voting</small></h4>
            <span class="label democrat">8</span>
            <span class="label republican">12</span>
          </div>
        </div>
      </div>

      <div class="cvContent_panel">
        <!--date--><h6 class="light-text float-right">2017-07-27</h6>
        <!--question--><h6 class="light-text">On Agreeing to the Amendment</h6>
        <!--description--><h4><a href="" style="color:white;text-decoration:underline;">Nadler of New York Part B Amendment No. 38</a></h4>
        <!--number-title--><p>H.R.3219 - Make America Secure Appropriations Act, 2018</p>
        <!--latest action--><p><strong>Read the second time. Placed on Senate Legislative Calendar under General Orders. Calendar No. 187.</strong></p>
        <hr>

        <div class="grid-x grid-padding-x">
          <div class="cell small-3">
            <h4><small>Result:</small> <span class="failed">Failed</span></h4>
          </div>
          <div class="cell small-3">
            <h4><small>Yes</small></h4>
            <span class="label democrat">169</span>
            <span class="label republican">3</span>
          </div>
          <div class="cell small-3">
            <h4><small>No</small></h4>
            <span class="label democrat">22</span>
            <span class="label republican">230</span>
          </div>
          <div class="cell small-3">
            <h4><small>Not Voting</small></h4>
            <span class="label democrat">3</span>
            <span class="label republican">7</span>
          </div>
        </div>
      </div>

    </div>
    <div class="cell large-4 js-homeUpcoming">

      <h2>Upcoming Bills</h2>
<!--
      <div class="cvContent_panel">
        <h6 class="light-text float-right">H.R.5078</h6>
        <h6 class="light-text">House</h6>
        <h4>TRID Improvement Act of 2018, as amended</h4>

        <div class="button-group secondary expanded small">
          <button class="button" data-open="exampleModal1">Bill Overview</button>
          <button class="button" data-open="exampleModal2">News Articles</button>
        </div>
      </div>
-->
    </div><!--.cell-->
  </div>
</div>

<div class="reveal large" id="exampleModal1" data-reveal>
  <h1>Get a Specific Bill <small>Pro Publica API</small></h1>

  <p>Use this request type to get details about a particular bill, including actions taken and votes. The attributes house_passage_vote and senate_passage_vote are populated (with the date of passage) only upon successful passage of the bill. Bills before the 113th Congress (prior to 2013) have fewer attribute values than those from the 113th Congress onward, because the more recent bill data comes from the bulk data provided by the Government Publishing Office. Details for the older bills came from scraping Thomas.gov, the former congressional site of the Library of Congress.</p>

  <p class="lead">HTTP Request</p>
  <p>GET https://api.propublica.org/congress/v1/{congress}/bills/{bill-id}.json</p>

  <p class="lead">The above command returns JSON structured like this:</p>

  <pre>
    {
    	"status": "OK",
    	"copyright": "Copyright (c) 2018 Pro Publica Inc. All Rights Reserved.",
    	"results": [
    		{
    			"bill_id": "hr5078-115",
    			"bill_slug": "hr5078",
    			"congress": "115",
    			"bill": "H.R.5078",
    			"bill_type": "hr",
    			"number": "H.R.5078",
    			"bill_uri": "https://api.propublica.org/congress/v1/115/bills/hr5078.json",
    			"title": "To amend the Real Estate Settlement Procedures Act of 1974 to modify requirements related to mortgage disclosures, and for other purposes.",
    			"short_title": "TRID Improvement Act of 2018",
    			"sponsor_title": "Rep.",
    			"sponsor": "French Hill",
    			"sponsor_id": "H001072",
    			"sponsor_uri": "https://api.propublica.org/congress/v1/members/H001072.json",
    			"sponsor_party": "R",
    			"sponsor_state": "AR",
    			"gpo_pdf_uri": null,
    			"congressdotgov_url": "https://www.congress.gov/bill/115th-congress/house-bill/5078",
    			"govtrack_url": "https://www.govtrack.us/congress/bills/115/hr5078",
    			"introduced_date": "2018-02-23",
    			"active": true,
    			"last_vote": null,
    			"house_passage": "2018-02-27",
    			"senate_passage": null,
    			"enacted": null,
    			"vetoed": null,
    			"cosponsors": 0,
    			"cosponsors_by_party": {},
    			"withdrawn_cosponsors": 0,
    			"primary_subject": "Finance and Financial Sector",
    			"committees": "Senate Banking, Housing, and Urban Affairs Committee",
    			"committee_codes": [
    				"SSBK",
    				"HSBA"
    			],
    			"subcommittee_codes": [],
    			"latest_major_action_date": "2018-02-28",
    			"latest_major_action": "Received in the Senate and Read twice and referred to the Committee on Banking, Housing, and Urban Affairs.",
    			"house_passage_vote": "2018-02-27",
    			"senate_passage_vote": null,
    			"summary": "TRID Improvement Act of 2018 This bill amends the Real Estate Settlement Procedures of 1974 to modify disclosure requirements applicable to mortgage loan transactions. Specifically, the disclosed charges for any title insurance premium shall be equal to the amount charged for each individual title insurance policy, subject to any discounts as required by either state regulation or the title company rate filings. ",
    			"summary_short": "TRID Improvement Act of 2018 This bill amends the Real Estate Settlement Procedures of 1974 to modify disclosure requirements applicable to mortgage loan transactions. Specifically, the disclosed charges for any title insurance premium shall be equal to the amount charged for each individual title insurance policy, subject to any discounts as required by either state regulation or the title company rate filings. ",
    			"versions": [],
    			"actions": [
    				{
    					"id": 9,
    					"chamber": "Senate",
    					"action_type": "IntroReferral",
    					"datetime": "2018-02-28",
    					"description": "Received in the Senate and Read twice and referred to the Committee on Banking, Housing, and Urban Affairs."
    				},
    				{
    					"id": 8,
    					"chamber": "House",
    					"action_type": "Floor",
    					"datetime": "2018-02-27",
    					"description": "On motion to suspend the rules and pass the bill, as amended Agreed to by voice vote. (text: CR H1306)"
    				},
    				{
    					"id": 7,
    					"chamber": "House",
    					"action_type": "Floor",
    					"datetime": "2018-02-27",
    					"description": "Considered under suspension of the rules. (consideration: CR H1306-1308)"
    				},
    				{
    					"id": 6,
    					"chamber": "House",
    					"action_type": "Floor",
    					"datetime": "2018-02-27",
    					"description": "Motion to reconsider laid on the table Agreed to without objection."
    				},
    				{
    					"id": 5,
    					"chamber": "House",
    					"action_type": "Floor",
    					"datetime": "2018-02-27",
    					"description": "On motion to suspend the rules and pass the bill, as amended Agreed to by voice vote."
    				},
    				{
    					"id": 4,
    					"chamber": "House",
    					"action_type": "Floor",
    					"datetime": "2018-02-27",
    					"description": "DEBATE - The House proceeded with forty minutes of debate on H.R. 5078."
    				},
    				{
    					"id": 3,
    					"chamber": "House",
    					"action_type": "Floor",
    					"datetime": "2018-02-27",
    					"description": "Considered under suspension of the rules."
    				},
    				{
    					"id": 2,
    					"chamber": "House",
    					"action_type": "Floor",
    					"datetime": "2018-02-27",
    					"description": "Mr. Hill moved to suspend the rules and pass the bill, as amended."
    				},
    				{
    					"id": 1,
    					"chamber": "House",
    					"action_type": "IntroReferral",
    					"datetime": "2018-02-23",
    					"description": "Referred to the House Committee on Financial Services."
    				}
    			],
    			"votes": []
    		}
    	]
    }
  </pre>

  <button class="close-button" data-close aria-label="Close modal" type="button">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div class="reveal large" id="exampleModal2" data-reveal>
  <h1>Recent articles about X <small>News API</small></h1>

  <p class="lead">HTTP Request</p>
  <p>GET https://newsapi.org/v2/everything?q=X&sortBy=publishedAt&apiKey=API_K</p>

  <p class="lead">The above command returns JSON structured like this:</p>

  <button class="close-button" data-close aria-label="Close modal" type="button">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div class="reveal large" id="js-modalBillArticles" data-reveal>
  <!-- Content will be loaded here from somwhere else, crazy! -->
</div>



<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.3/js/foundation.min.js"></script>
<script>
  $(document).foundation();
</script>

<script>

  $.ajax({
   url: "https://api.propublica.org/congress/v1/bills/upcoming/house.json",
   type: "GET",
   dataType: 'json',
   headers: {'X-API-Key': 'sHCEuVsfOi06N1Ltq7cIYA2D4J80qhMy7cOa1SWt'}
   //async: false
  })
  .done(function(dataJSON){ // function call when response is received, dataJSON is response from ajax call

    var dataString = JSON.stringify(dataJSON,null,'\t'); // convert json object to string

    var dataUpcomingJSON = dataJSON.results[0].bills; // JSON object with only array of votes
    var voteRowHTML; // string with HTML for display

    for (var i = 0; i < dataUpcomingJSON.length; i++) { // loop through votes

      // create HTML for current vote
      voteRowHTML =
        '<div class="cvContent_panel"> \n' +
          '<h6 class="light-text float-right">' + dataUpcomingJSON[i].bill_number + '</h6> \n' +
          '<h6 class="light-text">' + dataUpcomingJSON[i].chamber + '</h6> \n' +
          '<h4>' + dataUpcomingJSON[i].description + '</h4> \n' +

          '<div class="button-group secondary expanded small"> \n' +
            '<button class="button">Bill Overview</button> \n' +
            '<button class="button js-billArticles" data-bill-slug="'+ dataUpcomingJSON[i].bill_slug + '"' +
                  ' data-bill-desc="' + dataUpcomingJSON[i].description + '"' +
                  ' data-bill-number="' + dataUpcomingJSON[i].bill_number + '">News Articles</button> \n' +
          '</div> \n' +
        '</div> \n'


        $(".js-homeUpcoming").append(voteRowHTML); // append html to results div
    }

    enableArticleButtons();
    //$("body").append('<pre>' + dataString + '</pre>'); // print the response to pre tag (maintaining spaces and line breaks)

  });

</script>

<script>

function enableArticleButtons() {

  $('.js-billArticles').on('click', function() {

    var sources = "the-new-york-times," +
                  "the-washington-post," +
                  "usa-today," +
                  "nbc-news," +
                  "reuters," +
                  "msnbc," +
                  "independant," +
                  "cnn," +
                  "cbs-news," +
                  "abc-news," +
                  "bbc-news"

    var billNumber = $(this).data("bill-number");
    var billSlug = $(this).data("bill-slug");
    var billDesc = $(this).data("bill-desc");

    var query = encodeURIComponent('"' + billSlug + '" OR "' + billNumber + '" ');

    console.log("sources: " + sources);
    console.log("query: " + query);

    var url = "https://newsapi.org/v2/everything?q=" + query + "&from=2017-01-01&sortBy=relevancy&sources=" + sources;

    console.log(url);

    $.ajax({
     url: url,
     type: "GET",
     dataType: 'json',
     headers: {'X-Api-Key': '6ae0570e133347c9af205810da9ef7e1'}
    })
    .done(function(dataJSON){ // function call when response is received, dataJSON is response from ajax call
      dataString = JSON.stringify(dataJSON,null,'\t'); // convert json object to string
      $('#js-modalBillArticles').html('<h4>Search by bill number</h4><p>API Call: ' + url + '</p>' + '<pre>' + dataString + '</pre>').foundation('open');


      query = encodeURIComponent(billDesc);
      url = "https://newsapi.org/v2/everything?q=" + query + "&from=2017-01-01&sortBy=relevancy&sources=" + sources;

      console.log(url);

      $.ajax({
       url: url,
       type: "GET",
       dataType: 'json',
       headers: {'X-Api-Key': '6ae0570e133347c9af205810da9ef7e1'}
      })
      .done(function(dataJSON){ // function call when response is received, dataJSON is response from ajax call
        dataString = JSON.stringify(dataJSON,null,'\t');
        $("#js-modalBillArticles").append('<hr><h4>Search by bill desc</h4><p>API Call: ' + url + '</p>' + '<pre>' + dataString + '</pre>');

      });

    });



  })
}
</script>

</body>
</html>
